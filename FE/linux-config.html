<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>linux-config | Chuune Wiki</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="//cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-shim.min.js"></script>
  <script src="//apps.bdimg.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
  <link rel="shortcut icon" type="image/png" href="favicon.png"/>
  <link rel="stylesheet" href="/css/index.css">
</head>

  <body>
  <header class="header-page">
    <div class="header-content">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <h1 class="header-logo">
        <a class="no-style header-link" href="
        
          /zh-cn
        
        ">Chuune Wiki</a>
      </h1>
      <div class="menu">
        <a class="no-style header-link" href="/zh-cn/archives">索引</a>
        <a class="no-style header-link" target="_blank" href="https://github.com/goumang2010/hexo-wiki/edit/master/source/_posts/zh-cn/linux-config.md">编辑</a>
        <a class="no-style header-link" href="/readme">README</a>
        <a class="no-style header-link" target="_blank" href="https://github.com/goumang2010/hexo-wiki">GitHub</a>
      </div>
      <div id="header-search-div" class="header-search-div">
        <input id="header-search-input" class="header-search-input" type="text" placeholder="搜索"/>
        <div id="header-search-box" class="header-search-box"><ul id="header-search-list"></ul></div>
      </div>
      <div class="header-lang-select-wrap header-link menu">
        <label>
        
          简体中文
        
        </label>
        <select id="header-lang-select" class="header-lang-select">
        
          
            <option
              value=""
              selected
            >
              简体中文
            </option>
          
            <option
              value=""
              
            >
              English
            </option>
          
        
        </select>
      </div>
    </div>
 <nav id="mobile-nav">
    <a class="no-style header-link" href="
    
      /zh-cn
    
    ">首页</a>
	<a href="/zh-cn/archives">索引</a>
	<a target="_blank" href="https://github.com/goumang2010/hexo-wiki/edit/master/source/_posts/zh-cn/linux-config.md">编辑</a>
	<a href="/readme">README</a>
	<a target="_blank" href="https://github.com/goumang2010/hexo-wiki">GitHub</a>
</nav>
</header>

  <section class="container">
  <h2>linux-config</h2>
  linux-config
  <article class="markdown-body article">
  <div class="toc"><ul><li class="level-1"><a href="#1."><span class="tocnumber">1.</span>&nbsp<span class="toctext">虚拟内存</span></a><ul><li class="level-2"><a href="#1.1."><span class="tocnumber">1.1.</span>&nbsp<span class="toctext">参考</span></a></li></ul></li><li class="level-1"><a href="#2."><span class="tocnumber">2.</span>&nbsp<span class="toctext">部署脚本</span></a><ul><li class="level-2"><a href="#2.1."><span class="tocnumber">2.1.</span>&nbsp<span class="toctext">php网站</span></a></li><li class="level-2"><a href="#2.2."><span class="tocnumber">2.2.</span>&nbsp<span class="toctext">node环境</span></a></li><li class="level-2"><a href="#2.3."><span class="tocnumber">2.3.</span>&nbsp<span class="toctext">其他</span></a></li><li class="level-2"><a href="#2.4."><span class="tocnumber">2.4.</span>&nbsp<span class="toctext">apt-get总安装命令</span></a></li><li class="level-2"><a href="#2.5."><span class="tocnumber">2.5.</span>&nbsp<span class="toctext">备份脚本</span></a><ul><li class="level-3"><a href="#2.5.1."><span class="tocnumber">2.5.1.</span>&nbsp<span class="toctext">程序备份</span></a></li><li class="level-3"><a href="#2.5.2."><span class="tocnumber">2.5.2.</span>&nbsp<span class="toctext">数据库备份</span></a></li></ul></li></ul></li></ul></div><h1 id="1."><a href="#1." class="headerlink" title="虚拟内存"></a>1. 虚拟内存</h1><ul>
<li>输入以下命令进行配置1G的交换区（虚拟内存）：<br>```</li>
</ul>
<ul>
<li>/dev/zero是一个输入设备，你可你用它来初始化文件。该设备无穷尽地提供0，可以使用任何你需要的数目——设备提供的要多的多。他可以用于向设备或文件写入字符串0。<br>dd if=/dev/zero of=/var/swap bs=1024 count=1048576<br>mkswap /var/swap</li>
<li>600权限表示仅是属主有读写权<br>chmod 600 /var/swap<br>swapon /var/swap</li>
<li>当内存使用70%的时候开始使用虚拟内存<br>sysctl vm.swappiness=30<br>echo “vm.swappiness=30” &gt;&gt; /etc/sysctl.conf</li>
<li>使系统倾向于保留缓存<br>echo “vm.vfs_cache_pressure=50” &gt;&gt; /etc/sysctl.conf<br>```</li>
</ul>
<h2 id="1.1."><a href="#1.1." class="headerlink" title="参考"></a>1.1. 参考</h2><p><a href="http://blog.csdn.net/nzing/article/details/9166057" target="_blank" rel="external">http://blog.csdn.net/nzing/article/details/9166057</a></p>
<p><a href="http://blog.itpub.net/29371470/viewspace-1250975" target="_blank" rel="external">http://blog.itpub.net/29371470/viewspace-1250975</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_8b5bb24f01016y3o.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_8b5bb24f01016y3o.html</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_4b4de658010006m7.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_4b4de658010006m7.html</a></p>
<h1 id="2."><a href="#2." class="headerlink" title="部署脚本"></a>2. 部署脚本</h1><h2 id="2.1."><a href="#2.1." class="headerlink" title="php网站"></a>2.1. php网站</h2><p>安装：</p>
<pre><code class="hljs ">apt-get install apache2 mysql-server php5 php5-mysql phpmyadmin</code></pre><p>配置：[Apache部署]] [<a href="Apache部署]] [[MySQL安装配置">MySQL安装配置</a></p>
<h2 id="2.2."><a href="#2.2." class="headerlink" title="node环境"></a>2.2. node环境</h2><p><a href="node安装">node安装</a></p>
<h2 id="2.3."><a href="#2.3." class="headerlink" title="其他"></a>2.3. 其他</h2><ul>
<li><a href="vsftpd">vsftpd</a></li>
<li><a href="ShadowSocks-libev搭建">ShadowSocks-libev搭建</a></li>
<li><a href="Ubuntu下mongoDB安装">Ubuntu下mongoDB安装</a></li>
<li><a href="Ubuntu下安装github">Ubuntu下安装github</a></li>
</ul>
<h2 id="2.4."><a href="#2.4." class="headerlink" title="apt-get总安装命令"></a>2.4. apt-get总安装命令</h2><pre><code class="hljs ">apt-get <span class="hljs-keyword">install</span> apache2 mysql-<span class="hljs-keyword">server</span> mongodb  vsftpd  <span class="hljs-keyword">build</span>-essential autoconf libtool libssl-dev  openssh-<span class="hljs-keyword">server</span> openssh-<span class="hljs-keyword">client</span> git-core php5</code></pre><h2 id="2.5."><a href="#2.5." class="headerlink" title="备份脚本"></a>2.5. 备份脚本</h2><p>若在win下创建文件并编辑，需要在vim中做如下检查和修改：</p>
<pre><code class="hljs ">:<span class="hljs-keyword">set</span> ff</code></pre><p>回车，显示fileformat=dos，重新设置下文件格式：</p>
<pre><code class="hljs ">:<span class="hljs-keyword">set</span> ff=unix</code></pre><p>保存退出:</p>
<pre><code class="hljs "><span class="hljs-symbol">:wq</span></code></pre><h3 id="2.5.1."><a href="#2.5.1." class="headerlink" title="程序备份"></a>2.5.1. 程序备份</h3><pre><code class="hljs "><span class="hljs-comment">##!/bin/bash</span>
----- create restore sh file<span class="hljs-comment">######</span>
- save folder
sf=<span class="hljs-string">"/home/ftp/data/backup"</span>
rn=<span class="hljs-variable">${sf}</span><span class="hljs-string">"/restore.sh"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"######restore sh######"</span> &gt; <span class="hljs-variable">$rn</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"sudo apt-get update"</span> &gt; <span class="hljs-variable">$rn</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"sudo apt-get install apache2 mysql-server mongodb  vsftpd  build-essential autoconf libtool libssl-dev  openssh-server openssh-client git-core php5"</span> &gt;&gt; <span class="hljs-variable">$rn</span>
----- backup configuration files <span class="hljs-comment">######</span>
conf_files=(
- backup apache2
<span class="hljs-string">"/etc/apache2/sites-available/000-default.conf"</span> 
- backup mysql
<span class="hljs-string">"/etc/mysql/my.cnf"</span> 
- backup mongodb
<span class="hljs-string">"/etc/mongodb.conf"</span>
- backup Vsftpd
<span class="hljs-string">"/etc/vsftpd.conf"</span>
- backup shadowsock
<span class="hljs-string">"/etc/shadowsocks.json"</span>
)
<span class="hljs-keyword">for</span> lf <span class="hljs-keyword">in</span> <span class="hljs-variable">${conf_files[@]}</span>
<span class="hljs-keyword">do</span>
   cp <span class="hljs-variable">$lf</span> <span class="hljs-variable">$sf</span>
   <span class="hljs-comment">##split the str</span>
    arr=(<span class="hljs-variable">${lf//// }</span>) 
    length=<span class="hljs-variable">${##arr[@]}</span> 
    filename=<span class="hljs-variable">${arr[length-1]}</span>
    <span class="hljs-comment">##backup original files</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"cp "</span><span class="hljs-variable">${lf}</span><span class="hljs-string">" "</span><span class="hljs-variable">${filename}</span><span class="hljs-string">".bak"</span> &gt;&gt; <span class="hljs-variable">$rn</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"cp "</span><span class="hljs-variable">${filename}</span><span class="hljs-string">" "</span><span class="hljs-variable">${lf}</span> &gt;&gt; <span class="hljs-variable">$rn</span>
<span class="hljs-keyword">done</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"echo finish!"</span> &gt;&gt; <span class="hljs-variable">$rn</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"finish!"</span></code></pre><h3 id="2.5.2."><a href="#2.5.2." class="headerlink" title="数据库备份"></a>2.5.2. 数据库备份</h3><pre><code class="hljs "><span class="hljs-meta">#</span><span class="bash"><span class="hljs-meta">#!/bin/bash</span></span>
----- backup mysql######
filename=wikibackup`data +%Y-%m-%d_%H%M%S`.sql.gz
mysqldump -hlocalhost -uXXX -pXXX --default-character-set=utf8 s9759044_wiki | gzip &gt;$filename
mutt goumang2010@qq.com -a $filename -s “ParkBackup”</code></pre> 
</section>

  <section class="footer">
  <div class="container">
    <span class="footer-item">Text is available under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></span>
    <span class="footer-item">Created by <a href="null">ZN</a></span>
    <span class="footer-item">Powered by <a href="https://hexo.io">Hexo</a></span>
    <span class="footer-item">Themed by <a href="https://github.com/xcatliu/hexo-theme-wiki-i18n">wiki-i18n</a></span>
    <span class="footer-item">Hosted by <a href="https://pages.github.com/">GitHub Pages</a></span>
  </div>
</section>

  <script>
  window.HEXO_DATA = {
    config: {"title":"Chuune Wiki","subtitle":"Write something","description":null,"author":"ZN","language":["zh-cn","en","default"],"timezone":null,"url":"http://yoursite.com","root":"/","permalink":":category/:title.html","permalink_defaults":null,"source_dir":"source","public_dir":"public","tag_dir":"tags","archive_dir":"archives","category_dir":"categories","code_dir":"downloads/code","i18n_dir":":lang","skip_render":null,"new_post_name":":lang/:title.md","default_layout":"post","titlecase":false,"external_link":true,"filename_case":0,"render_drafts":false,"post_asset_folder":false,"relative_link":false,"future":true,"highlight":{"enable":false,"auto_detect":true,"line_number":false,"tab_replace":null},"default_category":"uncategorized","category_map":null,"tag_map":null,"date_format":"YYYY-MM-DD","time_format":"HH:mm:ss","per_page":1000,"pagination_dir":"page","theme":"wiki-i18n","deploy":{"type":"git","repo":"git@github.com:goumang2010/hexo-wiki.git","branch":"gh-pages","message":null},"author_link":null,"github":"https://github.com/goumang2010/hexo-wiki","index_generator":{"per_page":10,"order_by":"-date"},"marked":{"gfm":true,"pedantic":false,"sanitize":false,"tables":true,"breaks":true,"smartLists":true,"smartypants":true},"jsonContent":{"meta":false,"pages":true,"posts":{"title":true,"date":true,"path":true,"text":true,"raw":false,"content":false,"slug":false,"updated":false,"comments":false,"link":false,"permalink":false,"excerpt":true,"categories":false,"tags":false}},"archive_generator":{"per_page":1000,"yearly":true,"monthly":true,"daily":false},"category_generator":{"per_page":1000},"tag_generator":{"per_page":1000},"server":{"port":4000,"log":false,"ip":"0.0.0.0","compress":false,"header":true}},
  };
</script>

  <script src="/js/dist/custom.min.js?v=10855702740"> </script>


  </body>
</html>
