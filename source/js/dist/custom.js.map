{"version":3,"file":null,"sources":["../src/utils.js","../src/lang.js","../src/mobile.js","../src/search.js"],"sourcesContent":["/**\r\n * [bind event]\r\n * @param  {[type]}   element [ele]\r\n * @param  {[type]}   event   [event name]\r\n * @param  {Function} cb      [callback func]\r\n * @param  {[type]}   capture [capture]\r\n * @example bind(ele, 'click', () => { ... })\r\n */\r\nexport const bindEvent = (element, event, cb, capture) => {\r\n    !element.addEventListener && (event = 'on' + event);\r\n    (element.addEventListener || element.attachEvent).call(element, event, cb, capture);\r\n    return cb;\r\n};\r\n","import { bindEvent } from './utils.js';\r\n\r\nconst select = document.getElementById('header-lang-select');\r\n\r\nbindEvent(select, 'change', (e) => {\r\n    e.preventDefault();\r\n    let option = e.target.querySelector(`[value=\"${e.target.value}\"]`);\r\n    location.href = option.dataset.href;\r\n});\r\n","// Mobile nav\r\n// console.log($);\r\nconst $ = window.$;\r\nconst $container = $('body');\r\nlet isMobileNavAnim = false;\r\nlet mobileNavAnimDuration = 200;\r\nlet startMobileNavAnim = function () {\r\n    isMobileNavAnim = true;\r\n};\r\n\r\nlet stopMobileNavAnim = function () {\r\n    setTimeout(function () {\r\n        isMobileNavAnim = false;\r\n    }, mobileNavAnimDuration);\r\n};\r\nlet $mnav = $('#mobile-nav');\r\n$('#main-nav-toggle').on('click', function () {\r\n    if (isMobileNavAnim) return;\r\n    startMobileNavAnim();\r\n    $container.toggleClass('mobile-nav-on');\r\n    $mnav.show();\r\n    stopMobileNavAnim();\r\n});\r\n// $(input).val('kkkk');\r\nbindClickEvent($container, function () {\r\n    if (isMobileNavAnim || !$container.hasClass('mobile-nav-on')) return;\r\n    $container.removeClass('mobile-nav-on');\r\n    $mnav.hide();\r\n});\r\n\r\nfunction bindClickEvent($ele, callback) {\r\n    $ele.on('click', callback);\r\n    $ele.on('touch', callback);\r\n}\r\n","import { bindEvent } from './utils.js';\r\nconst input = document.getElementById('header-search-input');\r\nconst box = document.getElementById('header-search-box');\r\nconst boxUl = document.getElementById('header-search-list');\r\n\r\n// http://chaoo.oschina.io/2016/11/09/%E8%87%AA%E5%AE%9A%E4%B9%89HEXO%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2Javascript-json.html\r\n// xhr加载数据\r\nlet searchData;\r\n\r\nfunction loadData(success) {\r\n    if (!searchData) {\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.open('GET', '/content.json', true);\r\n        xhr.onload = function () {\r\n            if (this.status >= 200 && this.status < 300) {\r\n                let res = JSON.parse(this.response || this.responseText);\r\n                searchData = (res instanceof Array) ? res : res.posts;\r\n                success(searchData);\r\n            } else {\r\n                console.error(this.statusText);\r\n            }\r\n        };\r\n        xhr.onerror = function () {\r\n            console.error(this.statusText);\r\n        };\r\n        xhr.send();\r\n    } else {\r\n        success(searchData);\r\n    }\r\n}\r\n\r\n// 匹配文章内容返回结果\r\nfunction matcher(post, regExp) {\r\n    // 匹配优先级：title  > text\r\n    return regtest(post.title, regExp) || regtest(post.text, regExp);\r\n}\r\n\r\nfunction regtest(raw, regExp) {\r\n    regExp.lastIndex = 0;\r\n    return regExp.test(raw);\r\n}\r\n\r\n// 渲染到页面\r\nfunction render(data) {\r\n    boxUl.innerHTML = '';\r\n    try {\r\n        data.forEach(function (post) {\r\n            let li = document.createElement('li');\r\n            li.innerHTML = `<a href=\"/${post.path}\">${post.title}</a>`;\r\n            boxUl.appendChild(li);\r\n        });\r\n    } catch (err) {\r\n        console.log(err);\r\n    }\r\n}\r\n\r\n// 查询\r\nfunction search(key) {\r\n    // 关键字 => 正则，空格隔开的看作多个关键字\r\n    // a b c => /a|b|c/gmi\r\n    if (key !== '') {\r\n        let regExp = new RegExp(key.replace(/[ ]/g, '|'), 'gmi');\r\n        loadData(function (data) {\r\n            let result = data.filter(function (post) {\r\n                return matcher(post, regExp);\r\n            });\r\n            box.style.display = 'block';\r\n            render(result);\r\n        });\r\n    } else {\r\n        render([]);\r\n        box.style.display = 'none';\r\n    }\r\n}\r\n\r\nbindEvent(input, 'keyup', (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    search(input.value);\r\n});\r\n"],"names":["bindEvent","element","event","cb","capture","addEventListener","attachEvent","call","select","document","getElementById","e","preventDefault","option","target","querySelector","value","href","dataset","$","window","$container","isMobileNavAnim","mobileNavAnimDuration","startMobileNavAnim","stopMobileNavAnim","$mnav","on","toggleClass","show","bindClickEvent","hasClass","removeClass","hide","$ele","callback","input","box","boxUl","searchData","loadData","success","xhr","XMLHttpRequest","open","onload","status","res","JSON","parse","response","responseText","Array","posts","error","statusText","onerror","send","matcher","post","regExp","regtest","title","text","raw","lastIndex","test","render","data","innerHTML","forEach","li","createElement","path","appendChild","err","log","search","key","RegExp","replace","result","filter","style","display","stopPropagation"],"mappings":"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"}