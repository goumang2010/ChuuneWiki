/*
 * customMudule v0.0.0
 * (c) 2017 Chuune
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function t(t){return"string"==typeof t?t.trim().replace(/\s+/g," ").split(" "):t}function e(t){if(!t)throw new Error("ctrlClass\u4f20\u5165\u5143\u7d20\u4e3a\u7a7a");this.ele=t,this.classList=t.classList}function n(t,e,n){this.headers={Accept:"*/*","Cache-Control":""},this.callback=n.callback,this.errHandler=n.errHandler||function(t){console.log("error: "+t)},this.url=t+"?"+l(e),this.options={_async:!0,timeout:3e4,attempts:2},this.attempts=0,this.aborted=!1,this.timeoutid=null;var o=t.match(/\/\/(.+?)\//);this.crossOrigin=o&&!!o[1]&&o[1]!==location.host}function o(t,e){return e.lastIndex=0,e.test(t)}function i(t){S.innerHTML="";try{t.forEach(function(t){var e=document.createElement("li");e.innerHTML='<a href="/'+t.path+'">'+t.title+"</a>",S.appendChild(e)})}catch(t){console.log(t)}}function r(t){return t.toLowerCase().replace(/^\s+|\s+$/g,"")}function s(t,e){if(""!==t){var n=new RegExp(t.replace(/[ ]/g,"|"),"gmi");x(function(i){var s=[],a=!0,c=!1,u=void 0;try{for(var l,h=i[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var p=l.value,f=p.title;t=r(t),t===r(f)?s.push({pri:0,post:p}):o(p.title,n)?s.push({pri:1,post:p}):o(p.text,n)&&s.push({pri:2,post:p})}}catch(t){c=!0,u=t}finally{try{!a&&h.return&&h.return()}finally{if(c)throw u}}e(s.sort(function(t,e){return t.pri-e.pri}).map(function(t){return t.post}))})}else e([])}function a(t){s(t,function(t){t.length?(C.style.display="block",i(t)):(i([]),C.style.display="none")})}function c(t,e){return s(t,function(t){var n=void 0;(n=t[0])&&(n=n.path)&&e(n)})}"document"in self&&("classList"in document.createElement("_")?function(){var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,o=arguments.length;for(n=0;n<o;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():function(t){if("Element"in t){var e=t.Element.prototype,n=Object,o=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array.prototype.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},r=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},s=function(t,e){if(""===e)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return i.call(t,e)},a=function(t){for(var e=o.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,r=n.length;i<r;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},c=a.prototype=[],u=function(){return new a(this)};if(r.prototype=Error.prototype,c.item=function(t){return this[t]||null},c.contains=function(t){return t+="",-1!==s(this,t)},c.add=function(){var t,e=arguments,n=0,o=e.length,i=!1;do{t=e[n]+"",-1===s(this,t)&&(this.push(t),i=!0)}while(++n<o);i&&this._updateClassName()},c.remove=function(){var t,e,n=arguments,o=0,i=n.length,r=!1;do{for(t=n[o]+"",e=s(this,t);-1!==e;)this.splice(e,1),r=!0,e=s(this,t)}while(++o<i);r&&this._updateClassName()},c.toggle=function(t,e){t+="";var n=this.contains(t),o=n?!0!==e&&"remove":!1!==e&&"add";return o&&this[o](t),!0===e||!1===e?e:!n},c.toString=function(){return this.join(" ")},n.defineProperty){var l={get:u,enumerable:!0,configurable:!0};try{n.defineProperty(e,"classList",l)}catch(t){-2146823252===t.number&&(l.enumerable=!1,n.defineProperty(e,"classList",l))}}else n.prototype.__defineGetter__&&e.__defineGetter__("classList",u)}}(self)),document.querySelector||(document.querySelector=function(t){var e=document.documentElement.firstChild,n=document.createElement("STYLE");return e.appendChild(n),document.__qsResult=[],n.styleSheet.cssText=t+"{x:expression(document.__qsResult.push(this))}",window.scrollBy(0,0),e.removeChild(n),document.__qsResult[0]||null}),document.querySelectorAll||(document.querySelectorAll=function(t){var e=document.documentElement.firstChild,n=document.createElement("STYLE");e.appendChild(n),document.__qsResult=[],n.styleSheet.cssText=t+"{x:expression(document.__qsResult.push(this))}",window.scrollBy(0,0),e.removeChild(n);var o=[];for(var i in document.__qsResult)o.push(document.__qsResult[i]);return o});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(t){var e=function(t,e,n){n="function"==typeof n?n():null===n?"":void 0===n?"":n,t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(n)};return function t(n,o,i){var r=void 0,s=void 0,a=void 0;if("[object Array]"===Object.prototype.toString.call(o))for(r=0,s=o.length;r<s;r++)t(n+"["+("object"===u(o[r])?r:"")+"]",o[r],i);else if(o&&"[object Object]"===o.toString())for(a in o)o.hasOwnProperty(a)&&(n?t(n+"["+a+"]",o[a],i,e):t(a,o[a],i,e));else if(n)e(i,n,o);else for(a in o)e(i,a,o[a]);return i}("",t,[]).join("&").replace(/%20/g,"+")},h=function(){return window.JSON?JSON.parse:function(t){return new Function("return"+t)()}}(),p=function(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}(),f=function(t,e,n,o){return!t.addEventListener&&(e="on"+e),(t.addEventListener||t.attachEvent).call(t,e,n,o),n},d=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=p?"touchstart":"click";return n?f(t,i,function(t){e.apply(this,arguments),t.preventDefault?(t.preventDefault(),t.stopPropagation()):t.returnValue=!1},o):f(t,i,e,o)};e.prototype.show=function(){this.ele.style.display="block"},e.prototype.hide=function(){this.ele.style.display="none"},e.prototype.hasClass=function(e){var n=this;return t(e).every(function(t){return!!n.classList.contains(t)})},e.prototype.addClass=function(e){var n=this;t(e).forEach(function(t){n.hasClass(t)||n.classList.add(t)})},e.prototype.removeClass=function(e){var n=this;t(e).forEach(function(t){n.classList.remove(t)})},e.prototype.toggleClass=function(e){var n=this;t(e).forEach(function(t){n.classList.toggle(t)})};var m="undefined"!=typeof window?window:self,y=void 0,v=m.XMLHttpRequest?function(){return new m.XMLHttpRequest}:function(){return new m.ActiveXObject("Microsoft.XMLHTTP")},g=""===v().responseType;n.prototype.abort=function(){this.aborted||(this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.aborted=!0)},n.prototype.handleResponse=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.xhr;if(clearTimeout(this.timeoutid),!this.aborted)try{if("json"===t.responseType){if("response"in t&&null===t.response)throw"The request response is empty";this.response=t.response}else this.response=h(t.responseText);if("status"in t&&!/^2|1223/.test(t.status))throw t.status+" ("+t.statusText+")";this.callback(this.response)}catch(t){this.handleError(t)}},n.prototype.handleTimeout=function(){this.aborted||(this.options.attempts&&++this.attempts===this.options.attempts?this.handleError({message:"Timeout ("+this.url+")"}):(this.xhr.abort(),this.send()))},n.prototype.handleError=function(t){console.log(t);var e=t&&t.message;this.aborted||(e="string"==typeof e?e:"Connection aborted",this.abort(),this.errHandler(e))},n.prototype.send=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.method,o=void 0===n?"get":n,i=e.url,r=void 0===i?this.url:i,s=e.options,a=void 0===s?this.options:s,c=e.headers,u=void 0===c?this.headers:c,l=v();if(this.crossOrigin&&m.XDomainRequest&&(l=new XDomainRequest,y=!0),y?l.open(o,r):l.open(o,r,a._async),this.xhr=l,!y)for(var h in u)u[h]&&l.setRequestHeader(h,u[h]);g||y?(l.onload=function(){t.handleResponse.apply(t)},l.onerror=function(){t.handleError.apply(t)},y&&(l.onprogress=function(){})):l.onreadystatechange=function(){4===l.readyState&&t.handleResponse.apply(t)},a._async?"timeout"in l?(l.timeout=a.timeout,l.ontimeout=function(){t.handleTimeout.apply(t)}):this.timeoutid=setTimeout(function(){t.handleTimeout.apply(t)},a.timeout):y&&(l.ontimeout=function(){}),y?setTimeout(function(){l.send(null)},0):l.send(null)};var b=document.getElementById("header-lang-select");f(b,"change",function(t){var e=t.target||t.srcElement;location.href=e.value});var w=document.body,E=new e(w),_=new e(document.querySelector("#mobile-nav")),L=!1;d(document.querySelector("#main-nav-toggle"),function(){L||(E.toggleClass("mobile-nav-on"),_.show(),L=!0)},!0),d(w,function(){!1!==L&&setTimeout(function(){E.removeClass("mobile-nav-on"),_.hide(),L=!1},100)});var T=document.getElementById("header-search-input"),C=document.getElementById("header-search-box"),S=document.getElementById("header-search-list"),R=void 0,x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};if(R&&R.length>0)return(x=function(t){return t(R)})(t);new n("/content.json",null,{callback:function(e){(R=e.posts)&&R.length>0&&t(R)}}).send()};x();var q=function(t,e){var n=void 0;return function(){for(var o=this,i=arguments.length,r=Array(i),s=0;s<i;s++)r[s]=arguments[s];n&&clearTimeout(n),n=setTimeout(function(){t.apply(o,r)},e)}}(a,200);f(T,"keyup",function(t){q(T.value),t.preventDefault?(t.preventDefault(),t.stopPropagation()):t.returnValue=!1}),d(document.body,function(t){"a"!==t.target.tagName.toLowerCase()&&(C.style.display="none")}),d(T,function(t){T.value&&(C.style.display="block")},!1),d(document.body,function(t){var e=t.target;if("a"===e.tagName.toLowerCase()){var n=void 0;/^[^#\/]+$/.test(n=e.getAttribute("href"))&&c(n,function(t){e.href="/"+t})}})});